---
id: lamehug-malware-leveraging-dynamic-ai-generated-commands
title: "AML.CS0044: LAMEHUG: Malware Leveraging Dynamic AI-Generated Commands"
type: case-study
sidebar_position: 45
---

# AML.CS0044: LAMEHUG: Malware Leveraging Dynamic AI-Generated Commands

In July 2025, Ukrainian authorities reported the emergence of LAMEHUG, a new AI-powered malware attributed to the Russian state-backed threat actor [APT28](https://attack.mitre.org/groups/G0007/) (also tracked as Forest Blizzard or UAC-0001). LAMEHUG uses a large language model (LLM) to dynamically generate commands on the infected hosts.

The campaign began with a phishing attack leveraging a compromised government email account to deliver a malicious ZIP archive disguised as Appendix.pdf.zip. The archive contained the LAMEHUG malware, a Python-based executable, packed with PyInstaller. When executed, the malware, makes calls to an LLM endpoint to generate malicious from natural language prompts. Dynamically generated commands may make the malware harder to detect. LAMEHUG was configured to collect files from the local system and exfiltrate them.

## Metadata

- **ID:** AML.CS0044
- **Incident Date:** 2025-06-03
- **Type:** incident
- **Target:** Ukraine’s security and defense sector
- **Actor:** APT28

## Procedure

### Step 1: Valid Accounts

**Technique:** [[frameworks/atlas/techniques/initial-access/valid-accounts|AML.T0012: Valid Accounts]]

APT28 gained access to a compromised official email account.

### Step 2: Phishing

**Technique:** [[frameworks/atlas/techniques/initial-access/phishing/phishing-spearphishing-via-LLM|AML.T0052: Phishing]]

APT28 sent a phishing email from the compromised account with an attachment containing malware.

### Step 3: Impersonation

**Technique:** [[frameworks/atlas/techniques/defense-evasion/impersonation|AML.T0073: Impersonation]]

The email impersonated a government ministry representative.

### Step 4: Masquerading

**Technique:** [[frameworks/atlas/techniques/defense-evasion/masquerading|AML.T0074: Masquerading]]

The attachment was called “Appendix.pdf.zip” which could confuse the recipient into thinking it was a legitimate PDF file.

### Step 5: User Execution

**Technique:** [[frameworks/atlas/techniques/execution/user-execution/user-execution-unsafe-AI-artifacts|AML.T0011: User Execution]]

The attachment contained an executable file with a .pif extension, created using PyInstaller from Python source code which CERT-UA classified it as LAMEHUG malware. Files with the .pif extension are executable on Windows.

### Step 6: Generate Malicious Commands

**Technique:** [[frameworks/atlas/techniques/ai-attack-staging/generate-malicious-commands|AML.T0102: Generate Malicious Commands]]

The LAMEHUG malware abused the Qwen 2.5 Coder 32B Instruct model Hugging Face API to generate malicious commands from natural language prompts.

### Step 7: Data from Local System

**Technique:** [[frameworks/atlas/techniques/collection/data-from-local-system|AML.T0037: Data from Local System]]

The LAMEHUG malware used the AI generated commands to collect system information (saved to `%PROGRAMDATA%\info\info.txt`) and recursively searched Documents, Desktop, and Downloads to stage files for exfiltration.

### Step 8: Exfiltration via Cyber Means

**Technique:** [[frameworks/atlas/techniques/exfiltration/exfiltration-via-cyber-means|AML.T0025: Exfiltration via Cyber Means]]

The LAMEHUG malware exfiltrated collected data to attacker controlled servers via SFTP or HTTP POST requests.

## References

1. [UAC-0001 cyberattacks on the security and defense sector using the LAMEHUG software tool, which uses LLM (large language model) (CERT-UA#16039)](https://cert.gov.ua/article/6284730)
2. [APT28’s New Arsenal: LAMEHUG, the First AI-Powered Malware](https://logpoint.com/en/blog/apt28s-new-arsenal-lamehug-the-first-ai-powered-malware)
3. [LameHug malware uses AI LLM to craft Windows data-theft commands in real-time](https://www.bleepingcomputer.com/news/security/lamehug-malware-uses-ai-llm-to-craft-windows-data-theft-commands-in-real-time/)
